{"version":3,"file":"bundles/exec.bundle.js","mappings":"MACA,IAAIA,OAAS,KAEb,MAAMC,kBAAoB,CACtB,eACA,gBACA,eACA,aACA,eACA,gBACA,aAEA,aACA,cACA,WAEA,eACA,cAGEC,OAASC,QAAQC,IACjBC,QAAUF,QAAQG,KAClBC,OAASJ,QAAQK,MAmBvB,SAASC,WAAWC,KAAQC,GACxB,GAAe,OAAXX,OACA,OAEJ,IAAII,EAAM,CAACM,KAAKA,EAAKE,QAAQD,EAAKE,KAAK,MACvCb,OAAOc,YAAYC,KAAKC,UAAUZ,GACtC,CAiBA,SAASa,MAAMC,IAEXC,KAAKD,IAEL,IAAIE,eAAiB,GAErB,IAAK,IAAIC,gBAAgBpB,kBAAkB,CACvC,IAAIqB,QACJ,IACIA,QAAUH,KAAKE,aACnB,CAAC,MAAME,GACHD,aAAUE,CACd,MAEgBA,IAAZF,SACAF,eAAeK,KAAKH,QAE5B,MAEUE,IAAPE,WAA0BF,IAARG,OAIrBC,QAAQF,KAAKC,MAAMP,eACvB,CAMA,SAASQ,QAAQC,EAAQC,EAASC,GAC9BC,OAAOL,MAAQ,WACXM,aAAa,IAAI,KACjBA,aAAe,WACX9B,QAAQK,MAAM,2BAClB,EACA0B,SAASC,eAAe,kBAAkBC,MAAMC,MAAQ,UACxDH,SAASC,eAAe,kBAAkBC,MAAME,OAAS,UACzDR,GACJ,EAEA,IAAI,IAAIS,KAAQR,EACT9B,kBAAkBuC,SAASD,EAAKE,QAC/BT,OAAOO,EAAKE,MAAQF,GAI5BP,OAAON,KAAOG,EAEd,IAAIa,EACR,CAEA,SAASC,eACLC,WAAW,GACXC,OAAO,KAEP,IAAK,IAAIC,EAAI,EAAGA,EAAI,IAAKA,GAAG,GAAI,CAC5B,IAAIC,GAAaC,WAAa,IAAIF,GAAK,IACnCG,EAAOH,EAAE,IAEbI,KAAiB,IAAZH,EAAiB,EAAQ,IAALE,GACzBE,KAAiB,IAAZJ,EAAiB,EAAG,GAAI,IAE7BG,KAAK,EAAe,IAAZH,EAAsB,IAALE,GACzBE,KAAK,EAAe,IAAZJ,EAAiB,GAAI,GACjC,CAEAG,KAAK,KAELE,QAAQC,OAAOC,OAAO,GAAG,IAEzBC,UAAUC,QACVC,KAAK,eAAe,IAAI,IAC5B,CAjHAtD,QAAQC,IAAM,YAAaO,GACvBF,WAAW,MAAME,EACrB,EAEAR,QAAQG,KAAO,YAAaK,GACxBF,WAAW,OAAOE,EACtB,EAEAR,QAAQK,MAAQ,YAAaG,GACzBF,WAAW,QAAQE,EACvB,EAGAqB,OAAO0B,QAAU,SAASlD,GACtBC,WAAW,QAAQD,EACvB,EAWAwB,OAAO2B,iBAAiB,WAAW,EAAGC,OAAMC,aACzB,OAAX7D,SACAA,OAAS6D,GAGb5C,MAAM2C,EAAK,IAGf1B,SAASyB,iBAAiB,eAAeG,IACrCA,EAAMC,gBAAgB,G","sources":["webpack:///./src/exec/index.js"],"sourcesContent":["\r\nlet parent = null;\r\n\r\nconst acceptedFunctions = [\r\n    \"mousePressed\",\r\n    \"mouseReleased\",\r\n    \"mouseClicked\",\r\n    \"mouseMoved\",\r\n    \"mouseDragged\",\r\n    \"doubleClicked\",\r\n    \"mouseWheel\",\r\n\r\n    \"keyPressed\",\r\n    \"keyReleased\",\r\n    \"keyTyped\",\r\n\r\n    \"touchStarted\",\r\n    \"touchEnded\",\r\n]\r\n\r\nconst oldLog = console.log;\r\nconst oldWarn = console.warn;\r\nconst oldErr = console.error;\r\n\r\nconsole.log = function (...args) {\r\n    logMessage(\"log\",args);\r\n}\r\n\r\nconsole.warn = function (...args) {\r\n    logMessage(\"warn\",args);\r\n}\r\n\r\nconsole.error = function (...args) {\r\n    logMessage(\"error\",args);\r\n}\r\n\r\n//log errors\r\nwindow.onerror = function(error) {\r\n    logMessage(\"error\",error);\r\n}\r\n\r\nfunction logMessage(type,...args){\r\n    if (parent === null) {\r\n        return;\r\n    }\r\n    let log = {type:type,message:args.join(\" \")};\r\n    parent.postMessage(JSON.stringify(log));\r\n}\r\n\r\n\r\nwindow.addEventListener(\"message\", ({ data, source }) => {\r\n    if (parent === null) {\r\n        parent = source;\r\n    }\r\n\r\n    runJs(data);\r\n});\r\n\r\ndocument.addEventListener('contextmenu', event => {\r\n    event.preventDefault();\r\n});\r\n\r\n\r\n\r\nfunction runJs(js){\r\n    //clear dangerous objects and run code\r\n    eval(js);\r\n\r\n    let eventFunctions = [];\r\n\r\n    for (let acceptedFunc of acceptedFunctions){\r\n        let funcDef;\r\n        try {\r\n            funcDef = eval(acceptedFunc);\r\n        }catch(e){\r\n            funcDef = undefined;\r\n        }\r\n\r\n        if (funcDef !== undefined) {\r\n            eventFunctions.push(funcDef);\r\n        }\r\n    }\r\n\r\n    if(draw===undefined||setup===undefined){\r\n        return;\r\n    }\r\n\r\n    startP5(draw,setup,eventFunctions);\r\n}\r\n\r\n\r\n//helpers\r\n\r\n\r\nfunction startP5(drawArg,setupArg,otherFunctions) {\r\n    window.setup = function(){\r\n        createCanvas(500,500);\r\n        createCanvas = function (){\r\n            console.error(\"createCanvas is disabled\");\r\n        }\r\n        document.getElementById(\"defaultCanvas0\").style.width = \"100vmin\";\r\n        document.getElementById(\"defaultCanvas0\").style.height = \"100vmin\";\r\n        setupArg()\r\n    };\r\n\r\n    for(let func of otherFunctions){\r\n        if(acceptedFunctions.includes(func.name)) {\r\n            window[func.name] = func;\r\n        }\r\n    }\r\n\r\n    window.draw = drawArg;\r\n\r\n    new p5();\r\n}\r\n\r\nfunction __canvasTest(){\r\n    background(0);\r\n    stroke(255);\r\n\r\n    for (let i = 0; i < 500; i+=10) {\r\n        let timeRatio = (frameCount % 500-i) / 490;\r\n        let bRat = i/500;\r\n\r\n        fill(timeRatio * 255, 0, bRat*255);\r\n        rect(timeRatio * 490, 0, 10, 10);\r\n\r\n        fill(0, timeRatio * 255, bRat*255);\r\n        rect(0, timeRatio * 490, 10, 10);\r\n    }\r\n\r\n    fill(255);\r\n\r\n    ellipse(mouseX,mouseY,10,10);\r\n\r\n    textAlign(CENTER);\r\n    text(\"Welcome back\",250,250);\r\n}\r\n"],"names":["parent","acceptedFunctions","oldLog","console","log","oldWarn","warn","oldErr","error","logMessage","type","args","message","join","postMessage","JSON","stringify","runJs","js","eval","eventFunctions","acceptedFunc","funcDef","e","undefined","push","draw","setup","startP5","drawArg","setupArg","otherFunctions","window","createCanvas","document","getElementById","style","width","height","func","includes","name","p5","__canvasTest","background","stroke","i","timeRatio","frameCount","bRat","fill","rect","ellipse","mouseX","mouseY","textAlign","CENTER","text","onerror","addEventListener","data","source","event","preventDefault"],"sourceRoot":""}